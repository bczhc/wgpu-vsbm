#!/bin/env ruby

def extract_frame_nine(input_file, output_file)
  unless File.exist?(input_file)
    puts "错误: 找不到文件 #{input_file}"
    return
  end

  lines = File.readlines(input_file)

  start_index = lines.find_index { |line| line.match?(/Frame 8:$/) }
  end_index = lines.find_index { |line| line.match?(/Frame 9:$/) }

  if start_index && end_index && end_index > start_index
    frame_content = lines[start_index...end_index]

    File.open(output_file, 'w') do |f|
      f.puts frame_content
    end
    puts "成功：已提取 #{input_file} 的内容至 #{output_file}"
  else
    fail
  end
end

# 处理两个指定的文件
files_to_process = {
  "native-vulkan.log" => "native-vulkan-frame.log",
  "wine-vkd3d.log" => "wine-vkd3d-frame.log"
}

files_to_process.each do |input, output|
  extract_frame_nine(input, output)
end
